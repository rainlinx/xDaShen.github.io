<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="JDBC学习笔记"><meta name="keywords" content="学习笔记"><meta name="author" content="xDaShen"><meta name="copyright" content="xDaShen"><title>JDBC学习笔记 | xDaShen's Blog</title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#JDBC"><span class="toc-number">1.</span> <span class="toc-text">JDBC</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-简介"><span class="toc-number">1.1.</span> <span class="toc-text">1. 简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-连接数据库的步骤"><span class="toc-number">1.2.</span> <span class="toc-text">2. 连接数据库的步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-注册驱动-只做一次"><span class="toc-number">1.2.1.</span> <span class="toc-text">2.1 注册驱动 (只做一次)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-建立连接-Connection"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.2 建立连接(Connection)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-创建执行SQL的语句-Statement"><span class="toc-number">1.2.3.</span> <span class="toc-text">2.3 创建执行SQL的语句(Statement)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-执行语句"><span class="toc-number">1.2.4.</span> <span class="toc-text">2.4 执行语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-处理执行结果-ResultSet"><span class="toc-number">1.2.5.</span> <span class="toc-text">2.5 处理执行结果(ResultSet)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-释放资源"><span class="toc-number">1.2.6.</span> <span class="toc-text">2.6 释放资源</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-基本的CRUD-创建、读取、更新、删除"><span class="toc-number">1.3.</span> <span class="toc-text">3. 基本的CRUD(创建、读取、更新、删除)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-模板代码"><span class="toc-number">1.3.1.</span> <span class="toc-text">3.1 模板代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-创建"><span class="toc-number">1.3.2.</span> <span class="toc-text">3.2 创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-读取"><span class="toc-number">1.3.3.</span> <span class="toc-text">3.3 读取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-更新"><span class="toc-number">1.3.4.</span> <span class="toc-text">3.4 更新</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-删除"><span class="toc-number">1.3.5.</span> <span class="toc-text">3.5 删除</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-总结"><span class="toc-number">1.3.6.</span> <span class="toc-text">3.6 总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-SQL注入-PreparedStatement和Statement"><span class="toc-number">1.4.</span> <span class="toc-text">4. SQL注入,PreparedStatement和Statement</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-数据类型"><span class="toc-number">1.5.</span> <span class="toc-text">5. 数据类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-一个简单用户相关的数据访问层"><span class="toc-number">1.6.</span> <span class="toc-text">6. 一个简单用户相关的数据访问层</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-事务"><span class="toc-number">1.7.</span> <span class="toc-text">7. 事务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-事务-ACID"><span class="toc-number">1.7.1.</span> <span class="toc-text">7.1 事务(ACID)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-事务-SavePoint"><span class="toc-number">1.7.2.</span> <span class="toc-text">7.2 事务(SavePoint)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-事务-JTA"><span class="toc-number">1.7.3.</span> <span class="toc-text">7.4 事务(JTA)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-隔离级别多线程并发读取数据时的正确性"><span class="toc-number">1.7.4.</span> <span class="toc-text">7.4 隔离级别多线程并发读取数据时的正确性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-存储过程"><span class="toc-number">1.8.</span> <span class="toc-text">8. 存储过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-其他的几个API"><span class="toc-number">1.9.</span> <span class="toc-text">9. 其他的几个API</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-元数据"><span class="toc-number">1.10.</span> <span class="toc-text">10. 元数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-DatabaseMetaData"><span class="toc-number">1.10.1.</span> <span class="toc-text">10.1 DatabaseMetaData</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-2-ResultSetMetaData"><span class="toc-number">1.10.2.</span> <span class="toc-text">10.2 ResultSetMetaData</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-数据源与连接池"><span class="toc-number">1.11.</span> <span class="toc-text">11. 数据源与连接池</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11-1-简介"><span class="toc-number">1.11.1.</span> <span class="toc-text">11.1 简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-2-简单数据源和连接池的实现"><span class="toc-number">1.11.2.</span> <span class="toc-text">11.2 简单数据源和连接池的实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-3-常用的开源实现DBCP"><span class="toc-number">1.11.3.</span> <span class="toc-text">11.3 常用的开源实现DBCP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-Spring的JDBC工具"><span class="toc-number">1.12.</span> <span class="toc-text">13. Spring的JDBC工具</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#13-1-JdbcTemplate"><span class="toc-number">1.12.1.</span> <span class="toc-text">13.1 JdbcTemplate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-2-NamedParamterJdbcTemplate"><span class="toc-number">1.12.2.</span> <span class="toc-text">13.2 NamedParamterJdbcTemplate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-3-SimpleJdbcTemplate"><span class="toc-number">1.12.3.</span> <span class="toc-text">13.3 SimpleJdbcTemplate</span></a></li></ol></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">xDaShen</div><div class="author-info__description text-center">一个秘密的地方偷偷的记录</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">9</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">2</span></a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">xDaShen's Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a></span></div><div id="post-info"><div id="post-title">JDBC学习笔记</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-12-05</time></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="JDBC"><a href="#JDBC" class="headerlink" title="JDBC"></a>JDBC</h1><h2 id="1-简介"><a href="#1-简介" class="headerlink" title="1. 简介"></a>1. 简介</h2><p>JDBC(Java Data Base Connectivity,java数据库连接),由一些接口和类构成的API。<br>J2SE的一部分,由java.sql,javax.sql包组成。</p>
<h2 id="2-连接数据库的步骤"><a href="#2-连接数据库的步骤" class="headerlink" title="2. 连接数据库的步骤"></a>2. 连接数据库的步骤</h2><h3 id="2-1-注册驱动-只做一次"><a href="#2-1-注册驱动-只做一次" class="headerlink" title="2.1 注册驱动 (只做一次)"></a>2.1 注册驱动 (只做一次)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Class.forName(“com.mysql.jdbc.Driver”);</span><br><span class="line">	推荐这种方式,不会对具体的驱动类产生依赖。</span><br><span class="line">	</span><br><span class="line">DriverManager.registerDriver(com.mysql.jdbc.Driver);</span><br><span class="line">	会造成DriverManager中产生两个一样的驱动,并会对具体的驱动类产生依赖。</span><br><span class="line">	</span><br><span class="line">System.setProperty(“jdbc.drivers”, “driver1:driver2”);</span><br><span class="line">	虽然不会对具体的驱动类产生依赖；但注册不太方便,所以很少使用。 </span><br><span class="line">	</span><br><span class="line">驱动类型(四种类型)</span><br></pre></td></tr></table></figure>

<h3 id="2-2-建立连接-Connection"><a href="#2-2-建立连接-Connection" class="headerlink" title="2.2 建立连接(Connection)"></a>2.2 建立连接(Connection)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Connection conn = DriverManager.getConnection(url, user, password);</span><br><span class="line">url格式：</span><br><span class="line">	JDBC:子协议:子名称<span class="comment">//主机名:端口/数据库名？属性名=属性值&amp;…</span></span><br><span class="line">User,password可以用“属性名=属性值”方式告诉数据库；</span><br><span class="line">其他参数如：useUnicode=<span class="keyword">true</span>&amp;characterEncoding=UTF-<span class="number">8</span>&amp;useSSL=<span class="keyword">false</span>。</span><br></pre></td></tr></table></figure>

<h3 id="2-3-创建执行SQL的语句-Statement"><a href="#2-3-创建执行SQL的语句-Statement" class="headerlink" title="2.3 创建执行SQL的语句(Statement)"></a>2.3 创建执行SQL的语句(Statement)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Statement</span><br><span class="line">	Statement st = conn.createStatement();</span><br><span class="line">	st.executeQuery(sql);</span><br><span class="line">PreparedStatement</span><br><span class="line">	String sql = “select * from table_name where col_name=?”;</span><br><span class="line">	PreparedStatement ps = conn.preparedStatement(sql);</span><br><span class="line">	ps.setString(<span class="number">1</span>, “col_value”);</span><br><span class="line">	ps.executeQuery();</span><br></pre></td></tr></table></figure>

<h3 id="2-4-执行语句"><a href="#2-4-执行语句" class="headerlink" title="2.4 执行语句"></a>2.4 执行语句</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ps.executeQuery();	<span class="comment">//执行查询</span></span><br><span class="line">ps.executeUpdate();	<span class="comment">//执行更新和插入和删除</span></span><br></pre></td></tr></table></figure>

<h3 id="2-5-处理执行结果-ResultSet"><a href="#2-5-处理执行结果-ResultSet" class="headerlink" title="2.5 处理执行结果(ResultSet)"></a>2.5 处理执行结果(ResultSet)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ResultSet rs = statement.executeQuery(sql);</span><br><span class="line">While(rs.next())&#123;</span><br><span class="line">	rs.getString(“col_name”);</span><br><span class="line">	rs.getInt(“col_name”);</span><br><span class="line">	<span class="comment">//…</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-6-释放资源"><a href="#2-6-释放资源" class="headerlink" title="2.6 释放资源"></a>2.6 释放资源</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">释放ResultSet, Statement,Connection.</span><br><span class="line">数据库连接(Connection)是非常稀有的资源,用完后必须马上释放,如果Connection不能及时正确的关闭将导致系统宕机。Connection的使用原则是尽量晚创建,尽量早的释放。</span><br></pre></td></tr></table></figure>

<h2 id="3-基本的CRUD-创建、读取、更新、删除"><a href="#3-基本的CRUD-创建、读取、更新、删除" class="headerlink" title="3. 基本的CRUD(创建、读取、更新、删除)"></a>3. 基本的CRUD(创建、读取、更新、删除)</h2><h3 id="3-1-模板代码"><a href="#3-1-模板代码" class="headerlink" title="3.1 模板代码"></a>3.1 模板代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Connection conn = <span class="keyword">null</span>;</span><br><span class="line">Statement st=<span class="keyword">null</span>;</span><br><span class="line">ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">	<span class="comment">//获得Connection</span></span><br><span class="line">	<span class="comment">//创建Statement</span></span><br><span class="line">	<span class="comment">//处理查询结果ResultSet</span></span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">	<span class="comment">//释放资源ResultSet, Statement,Connection</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-2-创建"><a href="#3-2-创建" class="headerlink" title="3.2 创建"></a>3.2 创建</h3><p>增加对应SQL的INSERT,返回增加成功的行(记录)数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">conn = getConnection();</span><br><span class="line">Statement st = conn.createStatement();</span><br><span class="line">String sql=“<span class="function">insert into <span class="title">user</span><span class="params">(name, age,regist_date )</span>” +  		“<span class="title">values</span><span class="params">(‘name’, <span class="number">10</span>, now()</span>)”</span>;</span><br><span class="line"><span class="keyword">int</span> i = st.executeUpdate(sql);</span><br><span class="line"><span class="comment">//i为插入的记录数</span></span><br></pre></td></tr></table></figure>

<h3 id="3-3-读取"><a href="#3-3-读取" class="headerlink" title="3.3 读取"></a>3.3 读取</h3><p>读取(查询)对应SQL的SELECT,返回查询结果</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">conn = getConnection();</span><br><span class="line">st = conn.createStatement();</span><br><span class="line">String sql = <span class="string">"select id, name, age, regist_date from user"</span>;</span><br><span class="line">rs = st.executeQuery(sql);</span><br><span class="line"><span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">		System.out.print(rs.getInt(<span class="string">"id"</span>) + <span class="string">" \t\t "</span>);</span><br><span class="line">		System.out.print(rs.getString(<span class="string">"name"</span>) + <span class="string">" \t\t "</span>);</span><br><span class="line">		System.out.print(rs.getInt(<span class="string">"age"</span>) + <span class="string">" \t\t "</span>);</span><br><span class="line">		System.out.print(rs.getTimestamp(<span class="string">"regist_date"</span>) + <span class="string">" \t\t "</span>);</span><br><span class="line">		System.out.println();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-4-更新"><a href="#3-4-更新" class="headerlink" title="3.4 更新"></a>3.4 更新</h3><p>更新(修改)对应SQL的UPDATE,返回被修改的行(记录)数 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">conn = getConnection();</span><br><span class="line">Statement st = conn.createStatement();</span><br><span class="line">String sql=“update person set name = <span class="string">'new name‘”;</span></span><br><span class="line"><span class="string">int i = st.executeUpdate(sql);</span></span><br><span class="line"><span class="string">//i为符合条件的记录数</span></span><br></pre></td></tr></table></figure>

<h3 id="3-5-删除"><a href="#3-5-删除" class="headerlink" title="3.5 删除"></a>3.5 删除</h3><p>删除对应SQL的DELETE,返回被删除的行(记录)数 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">conn = getConnection();</span><br><span class="line">Statement st = conn.createStatement();</span><br><span class="line">String sql=“delete from user where id=<span class="number">1</span>”;</span><br><span class="line"><span class="keyword">int</span> i = st.executeUpdate(sql);</span><br><span class="line"><span class="comment">//i为删掉的记录数</span></span><br></pre></td></tr></table></figure>

<h3 id="3-6-总结"><a href="#3-6-总结" class="headerlink" title="3.6 总结"></a>3.6 总结</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">增、删、改用Statement.executeUpdate来完成,返回整数(匹配的记录数),这类操作相对简单。</span><br><span class="line">查询用Statement.executeQuery来完成,返回的是ResultSet对象,ResultSet中包含了查询的结果；查询相对于增、删、改要复杂一些,因为有查询结果要处理。</span><br></pre></td></tr></table></figure>

<h2 id="4-SQL注入-PreparedStatement和Statement"><a href="#4-SQL注入-PreparedStatement和Statement" class="headerlink" title="4. SQL注入,PreparedStatement和Statement"></a>4. SQL注入,PreparedStatement和Statement</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">在SQL中包含特殊字符或SQL的关键字(如：<span class="string">' or 1 or '</span>)时Statement将出现不可预料的结果(出现异常或查询的结果不正确),可用PreparedStatement来解决。</span><br><span class="line">PreperedStatement(从Statement扩展而来)相对Statement的优点：</span><br><span class="line">	<span class="number">1</span>.没有SQL注入的问题。</span><br><span class="line">	<span class="number">2</span>.Statement会使数据库频繁编译SQL,可能造成数据库缓冲区溢出。</span><br><span class="line">	<span class="number">3</span>.数据库和驱动可以对PreperedStatement进行优化(只有在相关联的数据库连接没有关闭的情况下有效)。</span><br></pre></td></tr></table></figure>

<h2 id="5-数据类型"><a href="#5-数据类型" class="headerlink" title="5. 数据类型"></a>5. 数据类型</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">详细信息见java.sql.Types</span><br><span class="line">几种特殊且比较常用的类型</span><br><span class="line">	<span class="number">1</span>.DATA,TIME,TIMESTAMP date,time,datetime</span><br><span class="line">存：ps.setDate(i,d); ps.setTime(i,t); ps.setTimestamp(i, ts);</span><br><span class="line">  	  取：rs.getDate(i); rs.getTime(i); rs.getTimestamp(i);</span><br><span class="line">	<span class="number">2</span>.CLOB -&gt; text(文本文件)</span><br><span class="line">	  存：ps.setCharacterStream(index, reader, length);</span><br><span class="line">	         ps.setString(i, s);</span><br><span class="line">	  取：reader = rs. getCharacterStream(i);</span><br><span class="line">	         reader = rs.getClob(i).getCharacterStream();</span><br><span class="line">	         string = rs.getString(i);</span><br><span class="line">	<span class="number">3</span>.BLOB -&gt; blob(字节文件,如图片)</span><br><span class="line">	 存：ps.setBinaryStream(i, inputStream, length);</span><br><span class="line">       取：rs.getBinaryStream(i);</span><br><span class="line">	        rs.getBlob(i).getBinaryStream();</span><br></pre></td></tr></table></figure>

<h2 id="6-一个简单用户相关的数据访问层"><a href="#6-一个简单用户相关的数据访问层" class="headerlink" title="6. 一个简单用户相关的数据访问层"></a>6. 一个简单用户相关的数据访问层</h2><p>J2EE三层架构简介<br>​        表示层 、业务逻辑层、数据访问层,三层之间用接口隔离。<br>定义domain对象User,定义存取用户的接口<br>用JDBC实现接口<br>用配置文件(properties)和反射实现与具体类的耦合 </p>
<h2 id="7-事务"><a href="#7-事务" class="headerlink" title="7. 事务"></a>7. 事务</h2><h3 id="7-1-事务-ACID"><a href="#7-1-事务-ACID" class="headerlink" title="7.1 事务(ACID)"></a>7.1 事务(ACID)</h3><p>原子性(atomicity)：组成事务处理的语句形成了一个逻辑单元,不能只执行其中的一部分。<br>一致性(consistency)：在事务处理执行前后,数据库是一致的(两个账户要么都变,或者都不变)。<br>隔离性(isolcation)：一个事务处理对另一个事务处理没有影响。<br>持续性(durability)：事务处理的效果能够被永久保存下来 。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">connection.setAutoCommit(<span class="keyword">false</span>);<span class="comment">//打开事务。</span></span><br><span class="line">connection.commit();<span class="comment">//提交事务。</span></span><br><span class="line">connection.rollback();<span class="comment">//回滚事务。</span></span><br></pre></td></tr></table></figure>

<h3 id="7-2-事务-SavePoint"><a href="#7-2-事务-SavePoint" class="headerlink" title="7.2 事务(SavePoint)"></a>7.2 事务(SavePoint)</h3><p>当只想撤销事务中的部分操作时可使用SavePoint</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//建立保存点</span></span><br><span class="line">SavePoint sp = connection.setSavepoint();</span><br><span class="line"><span class="comment">//回滚到保存点</span></span><br><span class="line">connection.rollerbak(sp);</span><br><span class="line"><span class="comment">//提交事务</span></span><br><span class="line">connection.commit();</span><br></pre></td></tr></table></figure>

<h3 id="7-4-事务-JTA"><a href="#7-4-事务-JTA" class="headerlink" title="7.4 事务(JTA)"></a>7.4 事务(JTA)</h3><p>跨越多个数据源的事务,使用JTA容器实现事务。<br>分成两阶段提交。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">javax.transaction.UserTransaction tx = (UserTransaction)ctx.lookup(“jndiName<span class="string">");</span></span><br><span class="line"><span class="string">	tx.begin();</span></span><br><span class="line"><span class="string">	//connection1 connection2 (可能来自不同的数据库)… </span></span><br><span class="line"><span class="string">    tx.commit();//tx.rollback();</span></span><br></pre></td></tr></table></figure>

<h3 id="7-4-隔离级别多线程并发读取数据时的正确性"><a href="#7-4-隔离级别多线程并发读取数据时的正确性" class="headerlink" title="7.4 隔离级别多线程并发读取数据时的正确性"></a>7.4 隔离级别多线程并发读取数据时的正确性</h3><p>connection.setTransactionIsolation(Connection.TRANSACTION_READ_COMMITTED);<br>V:可能出现,X:不会出现<br>| 隔离级别                   | 脏读 | 不可重复读 | 幻读 |<br>| ————————– | —- | ———- | —- |<br>| 读未提交(Read Uncommitted) | V    | V          | V    |<br>| 读已提交(Read Committed)   | X    | V          | V    |<br>| 可重复读(Repeatable Read)  | X    | X          | V    |<br>| 可串行化                   | X    | X          | X    |</p>
<h2 id="8-存储过程"><a href="#8-存储过程" class="headerlink" title="8. 存储过程"></a>8. 存储过程</h2><p>CallableStatement(从PreperedStatement扩展来)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cs = connection.prepareCall(“&#123;<span class="function">call <span class="title">psname</span><span class="params">(?,?,?)</span>&#125;”)</span>;</span><br><span class="line">cs.registerOutParameter(index, Types.INTEGER);</span><br><span class="line">cs.setXXX(i, xxxx);</span><br><span class="line">cs.executeUpdate();</span><br><span class="line"><span class="keyword">int</span> id=cs.getInt(index);</span><br></pre></td></tr></table></figure>

<h2 id="9-其他的几个API"><a href="#9-其他的几个API" class="headerlink" title="9. 其他的几个API"></a>9. 其他的几个API</h2><p>返回插入语句的主键：Statement.getGeneratedKeys()</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PreparedStatement ps = connection.prepareStatement(sql,	Statement.RETURN_GENERATED_KEYS);</span><br><span class="line">ps.executeUpdate();</span><br><span class="line">ResultSet rs = st.getGeneratedKeys();rs.getInt(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<p>批处理,可以大幅度提升大量增、删、改的速度。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PreparedStatement.addBatch();</span><br><span class="line">PreparedStatement.executeBatch();</span><br></pre></td></tr></table></figure>

<p>可滚动的结果集</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Statement st = </span><br><span class="line">connection.createStatement(ResultSet.TYPE_SCROLL_SENSITIVE,	ResultSet.CONCUR_UPDATABLE);</span><br><span class="line">ResultSet rs = st.executeQuery(sql);</span><br><span class="line">rs.beforeFirst(); rs.afterLast();rs.first();rs.isFirst();rs.last();rs.isLast();</span><br><span class="line">rs.absolute(<span class="number">9</span>);rs.moveToInsertRow();</span><br></pre></td></tr></table></figure>

<p>可更新的结果集</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">conn.createStatement(ResultSet.TYPE_SCROLL_SENSITIVE,</span><br><span class="line">				ResultSet.CONCUR_UPDATABLE);</span><br><span class="line">rs.updateString(<span class="string">"col name"</span>, <span class="string">"new value"</span>);</span><br><span class="line">rs.updateRow();</span><br></pre></td></tr></table></figure>

<h2 id="10-元数据"><a href="#10-元数据" class="headerlink" title="10. 元数据"></a>10. 元数据</h2><h3 id="10-1-DatabaseMetaData"><a href="#10-1-DatabaseMetaData" class="headerlink" title="10.1 DatabaseMetaData"></a>10.1 DatabaseMetaData</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DatabaseMetaData meta = connection.getMetaData();</span><br></pre></td></tr></table></figure>

<p>通过DatabaseMetaData可以获得数据库相关的信息如：数据库版本、数据库名、数据库厂商信息、是否支持事务、是否支持某种事务隔离级别,是否支持滚动结果集等。</p>
<h3 id="10-2-ResultSetMetaData"><a href="#10-2-ResultSetMetaData" class="headerlink" title="10.2 ResultSetMetaData"></a>10.2 ResultSetMetaData</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ResultSetMetaData meta = rs.getMetaData();</span><br><span class="line">通过ResultSetMetaData可以获得结果有几列、各列名、各列别名、各列类型等。 </span><br><span class="line">可以将ResultSet放入Map(key:列名 value:列值)。</span><br><span class="line">用反射ResultSetMetaData将查询结果读入对象中(简单的O/RMapping) </span><br><span class="line">	<span class="number">1</span>)让SQL语句中列别名和要读入的对象属性名一样；</span><br><span class="line">	<span class="number">2</span>)通过ResultSetMetaData获得结果列数和列别名；</span><br><span class="line">	<span class="number">3</span>)通过反射将对象的所有setXxx方法找到;</span><br><span class="line">	<span class="number">4</span>)将<span class="number">3</span>)找到的方法setXxx和<span class="number">2</span>)找到的列别名进行匹配(即方法中的xxx于列别名相等)；</span><br><span class="line">	<span class="number">5</span>)由上一步找到的方法和列别名对应关系进行赋值</span><br><span class="line">	Method.invoke(obj, rs.getObject(columnAliasName));</span><br></pre></td></tr></table></figure>

<h2 id="11-数据源与连接池"><a href="#11-数据源与连接池" class="headerlink" title="11. 数据源与连接池"></a>11. 数据源与连接池</h2><h3 id="11-1-简介"><a href="#11-1-简介" class="headerlink" title="11.1 简介"></a>11.1 简介</h3><p>DataSource用来取代DriverManager来获取Connection；<br>通过DataSource获得Connection速度很快；<br>通过DataSource获得的Connection都是已经被包裹过的(不是驱动原来的连接),他的close方法已经被修改。<br>一般DataSource内部会用一个连接池来缓存Connection,这样可以大幅度提高数据库的访问速度；<br>连接池可以理解成一个能够存放Connection的Collection；<br>我们的程序只和DataSource打交道,不会直接访问连接池；</p>
<h3 id="11-2-简单数据源和连接池的实现"><a href="#11-2-简单数据源和连接池的实现" class="headerlink" title="11.2 简单数据源和连接池的实现"></a>11.2 简单数据源和连接池的实现</h3><p>使用装饰模式的Connection(核心代码)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyConnection</span> <span class="keyword">implements</span> <span class="title">Connection</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Connection realConn;</span><br><span class="line">	<span class="keyword">private</span> LinkedList connPool;</span><br><span class="line">	MyConnection(Connection rConn, LinkedList cPool)&#123;</span><br><span class="line">		<span class="keyword">this</span>.realConn=rConn;</span><br><span class="line">		<span class="keyword">this</span>.connPool=cPool;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.connPool.addLast(<span class="keyword">this</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//….</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>DataSource(核心代码)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyDataSource</span> <span class="keyword">implements</span> <span class="title">DataSource</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> LinkedList connPool = <span class="keyword">new</span> Vector();</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Connection <span class="title">getConneciton</span> <span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="keyword">this</span>.connPool.size()&gt;<span class="number">0</span>)</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">this</span>.connPool.removeFirst(<span class="number">0</span>);</span><br><span class="line">		<span class="keyword">return</span> createConnection();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">private</span> Connection <span class="title">createConnection</span><span class="params">()</span></span>&#123;</span><br><span class="line">	  Connection realConn = DriverManager.getConnection();</span><br><span class="line">	  Connection myConn = </span><br><span class="line">		<span class="keyword">new</span> MyConnection(realConn,<span class="keyword">this</span>.connPool);</span><br><span class="line">	  <span class="keyword">return</span> myConn;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//….</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="11-3-常用的开源实现DBCP"><a href="#11-3-常用的开源实现DBCP" class="headerlink" title="11.3 常用的开源实现DBCP"></a>11.3 常用的开源实现DBCP</h3><p>使用DBCP必须用的三个包：<br>​    commons-dbcp-1.2.1.jar, commons-pool-1.2.jar, commons-collections-3.1.jar；<br>配置参数：<br>jdbc.properties</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">#连接设置</span><br><span class="line">driverClassName=com.mysql.jdbc.Driver</span><br><span class="line">url=jdbc:mysql:<span class="comment">//localhost:3306/jdbc</span></span><br><span class="line">username=root</span><br><span class="line">password=root</span><br><span class="line"></span><br><span class="line">#&lt;!-- 初始化连接 --&gt;</span><br><span class="line">initialSize=<span class="number">10</span></span><br><span class="line"></span><br><span class="line">#最大连接数量</span><br><span class="line">maxActive=<span class="number">50</span></span><br><span class="line"></span><br><span class="line">#&lt;!-- 最大空闲连接 --&gt;</span><br><span class="line">maxIdle=<span class="number">20</span></span><br><span class="line"></span><br><span class="line">#&lt;!-- 最小空闲连接 --&gt;</span><br><span class="line">minIdle=<span class="number">5</span></span><br><span class="line"></span><br><span class="line">#&lt;!-- 超时等待时间以毫秒为单位 6000毫秒/1000等于60秒 --&gt;</span><br><span class="line">maxWait=<span class="number">60000</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#JDBC驱动建立连接时附带的连接属性属性的格式必须为这样：[属性名=property;] </span><br><span class="line">#注意："user" 与 "password" 两个属性会被明确地传递,因此这里不需要包含他们。</span><br><span class="line">connectionProperties=useUnicode=<span class="keyword">true</span>;characterEncoding=gbk</span><br><span class="line"></span><br><span class="line">#指定由连接池所创建的连接的自动提交(auto-commit)状态。</span><br><span class="line">defaultAutoCommit=<span class="keyword">true</span></span><br><span class="line"></span><br><span class="line">#driver default 指定由连接池所创建的连接的只读(read-only)状态。</span><br><span class="line">#如果没有设置该值,则“setReadOnly”方法将不被调用。(某些驱动并不支持只读模式,如：Informix)</span><br><span class="line">defaultReadOnly=</span><br><span class="line"></span><br><span class="line">#driver default 指定由连接池所创建的连接的事务级别(TransactionIsolation)。</span><br><span class="line">#可用值为下列之一：(详情可见javadoc。)NONE,READ_UNCOMMITTED, READ_COMMITTED, REPEATABLE_READ, SERIALIZABLE</span><br><span class="line">defaultTransactionIsolation=READ_UNCOMMITTED</span><br></pre></td></tr></table></figure>

<p>代码中读取配置信息</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Properties properties= <span class="keyword">new</span> Properties();</span><br><span class="line">ppt.load(ClassLoader.getSystemResourceAsStream(<span class="string">"jdbc.properties"</span>));</span><br><span class="line">DataSource dataSource = BasicDataSourceFactory.createDataSource(properties)； </span><br><span class="line">Connection conn = dataSource.getConnection();</span><br></pre></td></tr></table></figure>

<h2 id="13-Spring的JDBC工具"><a href="#13-Spring的JDBC工具" class="headerlink" title="13. Spring的JDBC工具"></a>13. Spring的JDBC工具</h2><h3 id="13-1-JdbcTemplate"><a href="#13-1-JdbcTemplate" class="headerlink" title="13.1 JdbcTemplate"></a>13.1 JdbcTemplate</h3><p>查询带有参数,和行映射方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">queryForObject</span><span class="params">(String sql, Object[] args, RowMapper rowMapper)</span>,使用自定义的UserRowMapper完成映射。</span></span><br><span class="line"><span class="function">一个RowMapper的常用实现BeanPropertyRowMapper,该实现可将结果集转换成一个Java <span class="title">Bean</span><span class="params">(字段名与Java Bean属性名不符合规范,可用别名处理)</span>。</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List <span class="title">query</span><span class="params">(String sql, Object[] args, RowMapper rowMapper)</span>返回多个结果。</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">queryForInt</span><span class="params">(String sql)</span><span class="params">(如:select count(*)</span> from user),其他结果比如String可用queryForObject方法向下转型。</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Map <span class="title">queryForMap</span><span class="params">(String sql, Object[] args)</span>返回若类型的<span class="title">Map</span><span class="params">(key：字段名或别名,value：列值)</span>。</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List <span class="title">queryForList</span><span class="params">(String sql, Object[] args)</span>返回多Map。</span></span><br></pre></td></tr></table></figure>

<p>更新：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">update</span><span class="params">(String sql, Object[] args)</span>。</span></span><br></pre></td></tr></table></figure>

<p>插入数据并获得结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">execute</span><span class="params">(ConnectionCallback action)</span></span></span><br></pre></td></tr></table></figure>

<h3 id="13-2-NamedParamterJdbcTemplate"><a href="#13-2-NamedParamterJdbcTemplate" class="headerlink" title="13.2 NamedParamterJdbcTemplate"></a>13.2 NamedParamterJdbcTemplate</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">NamedParameterJdbcTemplate内部包含了一个JdbcTemplate,所以JdbcTemplate能做的事情NamedParameterJdbcTemplate都能干； </span><br><span class="line">NamedParameterJdbcTemplate相对于JdbcTemplate主要增加了参数可以命名的功能。</span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">queryForObject</span><span class="params">(String sql, Map paramMap, RowMapper rowMapper)</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">queryForObject</span><span class="params">(String sql, SqlParameterSource paramSource, RowMapper rowMapper)</span></span></span><br><span class="line"><span class="function">	SqlParameterSource的两个主要实现MapSqlParameterSource</span></span><br><span class="line"><span class="function">	和BeanPropertySqlParameterSource</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">update</span><span class="params">(String sql, SqlParameterSource paramSource, KeyHolder generatedKeyHolder)</span>保存数据获得主键。</span></span><br></pre></td></tr></table></figure>

<h3 id="13-3-SimpleJdbcTemplate"><a href="#13-3-SimpleJdbcTemplate" class="headerlink" title="13.3 SimpleJdbcTemplate"></a>13.3 SimpleJdbcTemplate</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SimpleJdbcTemplate内部包含了一个NamedParameterJdbcTemplate;</span><br><span class="line">所以NamedParameterJdbcTemplate能做的事情SimpleJdbcTemplate都能干,SimpleJdbcTemplate相对于NamedParameterJdbcTemplate主要增加了JDK5.0的泛型和可变长度参数支持。</span><br><span class="line"><span class="keyword">public</span> &lt;T&gt; <span class="function">List&lt;T&gt; <span class="title">query</span><span class="params">(String sql, ParameterizedRowMapper&lt;T&gt; rm, Object... args)</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> &lt;T&gt; T <span class="title">queryForObject</span><span class="params">(String sql, ParameterizedRowMapper&lt;T&gt; rm, SqlParameterSource args)</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> &lt;T&gt; List&lt;T&gt; <span class="title">query</span><span class="params">(String sql, ParameterizedRowMapper&lt;T&gt; rm, SqlParameterSource args)</span></span></span><br><span class="line"><span class="function">getJdbcOperations返回的是<span class="title">JdbcOperations</span><span class="params">(实现JdbcTemplate)</span></span></span><br><span class="line"><span class="function">getNamedParameterJdbcOperations返回的是<span class="title">NamedParameterJdbcOperations</span><span class="params">(实现是NamedParameterJdbcTemplate)</span></span></span><br></pre></td></tr></table></figure></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">xDaShen</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://yoursite.com/2018/12/05/JDBC学习笔记/">http://yoursite.com/2018/12/05/JDBC学习笔记/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/学习笔记/">学习笔记</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2018/12/05/Java学习笔记/"><i class="fa fa-chevron-left">  </i><span>Java学习笔记</span></a></div><div class="next-post pull-right"><a href="/2018/12/05/MyBatis学习笔记/"><span>MyBatis学习笔记</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2019 By xDaShen</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
}</script></body></html>