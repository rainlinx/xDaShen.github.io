<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="SpringMVC学习笔记"><meta name="keywords" content="学习笔记"><meta name="author" content="xDaShen"><meta name="copyright" content="xDaShen"><title>SpringMVC学习笔记 | xDaShen's Blog</title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#SpringMVC学习笔记"><span class="toc-number">1.</span> <span class="toc-text">SpringMVC学习笔记</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-SpringMVC框架"><span class="toc-number">1.1.</span> <span class="toc-text">1. SpringMVC框架</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-springmvc流程"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1 springmvc流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-组件说明"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.2 组件说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-组件"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.2 组件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-入门程序"><span class="toc-number">1.2.</span> <span class="toc-text">2. 入门程序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-非注解的处理器映射器和适配器"><span class="toc-number">1.3.</span> <span class="toc-text">3. 非注解的处理器映射器和适配器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-非注解的处理器映射器"><span class="toc-number">1.3.1.</span> <span class="toc-text">3.1 非注解的处理器映射器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-非注解的处理器适配器"><span class="toc-number">1.3.2.</span> <span class="toc-text">3.2 非注解的处理器适配器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-DispatcherServlet-properties"><span class="toc-number">1.4.</span> <span class="toc-text">4. DispatcherServlet.properties</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-注解的处理器映射器和适配器"><span class="toc-number">1.5.</span> <span class="toc-text">4.1 注解的处理器映射器和适配器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-配置注解映射器和适配器"><span class="toc-number">1.5.1.</span> <span class="toc-text">4.2 配置注解映射器和适配器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-开发注解Handler"><span class="toc-number">1.5.2.</span> <span class="toc-text">4.3 开发注解Handler</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-在spring容器中加载Handler"><span class="toc-number">1.5.3.</span> <span class="toc-text">4.4 在spring容器中加载Handler</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-视图解析器（jsp）"><span class="toc-number">1.6.</span> <span class="toc-text">5. 视图解析器（jsp）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-RequestMapping"><span class="toc-number">1.7.</span> <span class="toc-text">6. @RequestMapping</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-controller方法的返回值"><span class="toc-number">1.8.</span> <span class="toc-text">7. controller方法的返回值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-参数绑定"><span class="toc-number">1.9.</span> <span class="toc-text">8. 参数绑定</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-spring参数绑定过程"><span class="toc-number">1.9.1.</span> <span class="toc-text">8.1 spring参数绑定过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-默认支持的类型"><span class="toc-number">1.9.2.</span> <span class="toc-text">8.2 默认支持的类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-简单类型"><span class="toc-number">1.9.3.</span> <span class="toc-text">8.3 简单类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-4-pojo绑定"><span class="toc-number">1.9.4.</span> <span class="toc-text">8.4 pojo绑定</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-5-复杂类型参数绑定"><span class="toc-number">1.9.5.</span> <span class="toc-text">8.5 复杂类型参数绑定</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-5-自定义参数绑定"><span class="toc-number">1.9.6.</span> <span class="toc-text">8.5 自定义参数绑定</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#8-51-自定义日期类型绑定"><span class="toc-number">1.9.6.1.</span> <span class="toc-text">8.51 自定义日期类型绑定</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-52-配置自定义参数绑定"><span class="toc-number">1.9.6.2.</span> <span class="toc-text">8.52 配置自定义参数绑定</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-乱码问题"><span class="toc-number">1.10.</span> <span class="toc-text">9. 乱码问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-1-post乱码"><span class="toc-number">1.10.1.</span> <span class="toc-text">9.1 post乱码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-2-get乱码"><span class="toc-number">1.10.2.</span> <span class="toc-text">9.2 get乱码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-springmvc校验"><span class="toc-number">1.11.</span> <span class="toc-text">10. springmvc校验</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-数据回显"><span class="toc-number">1.12.</span> <span class="toc-text">11. 数据回显</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#11-1-什么是数据回显"><span class="toc-number">1.12.0.1.</span> <span class="toc-text">11.1 什么是数据回显</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-2-pojo数据回显"><span class="toc-number">1.12.1.</span> <span class="toc-text">11.2 pojo数据回显</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-3-简单类型数据回显"><span class="toc-number">1.12.2.</span> <span class="toc-text">11.3 简单类型数据回显</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-springmvc校验（to-do）"><span class="toc-number">1.13.</span> <span class="toc-text">12. springmvc校验（to do）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-异常处理"><span class="toc-number">1.14.</span> <span class="toc-text">12. 异常处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#12-1-异常处理思路"><span class="toc-number">1.14.1.</span> <span class="toc-text">12.1 异常处理思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-2-自定义异常类"><span class="toc-number">1.14.2.</span> <span class="toc-text">12.2 自定义异常类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-3-全局异常处理器"><span class="toc-number">1.14.3.</span> <span class="toc-text">12.3 全局异常处理器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-上传"><span class="toc-number">1.15.</span> <span class="toc-text">13. 上传</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#13-1-springmvc中添加对多部件类型解析"><span class="toc-number">1.15.1.</span> <span class="toc-text">13.1  springmvc中添加对多部件类型解析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-2-添加上传的jar包"><span class="toc-number">1.15.2.</span> <span class="toc-text">13.2 添加上传的jar包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-3-上传图片页面"><span class="toc-number">1.15.3.</span> <span class="toc-text">13.3 上传图片页面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-4-controller"><span class="toc-number">1.15.4.</span> <span class="toc-text">13.4 controller</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-json数据交互"><span class="toc-number">1.16.</span> <span class="toc-text">14. json数据交互</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#14-1-为什么要进行json数据交互"><span class="toc-number">1.16.1.</span> <span class="toc-text">14.1 为什么要进行json数据交互</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-2-SpringMVC进行json交互"><span class="toc-number">1.16.2.</span> <span class="toc-text">14.2 SpringMVC进行json交互</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-3-环境准备"><span class="toc-number">1.16.3.</span> <span class="toc-text">14.3 环境准备</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#14-3-1-maven添加相关依赖"><span class="toc-number">1.16.3.1.</span> <span class="toc-text">14.3.1 maven添加相关依赖</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#14-3-2-配置json转换器"><span class="toc-number">1.16.3.2.</span> <span class="toc-text">14.3.2 配置json转换器</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-4-json交互测试"><span class="toc-number">1.16.4.</span> <span class="toc-text">14.4 json交互测试</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#14-4-1-输入json，输出json"><span class="toc-number">1.16.4.1.</span> <span class="toc-text">14.4.1 输入json，输出json</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#14-4-1-1-jsp页面"><span class="toc-number">1.16.4.1.1.</span> <span class="toc-text">14.4.1.1 jsp页面</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#14-4-1-2-controller"><span class="toc-number">1.16.4.2.</span> <span class="toc-text">14.4.1.2 controller</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#14-4-2-输入key-value，输出是json串"><span class="toc-number">1.16.4.3.</span> <span class="toc-text">14.4.2 输入key/value，输出是json串</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#14-4-2-1-jsp页面"><span class="toc-number">1.16.4.4.</span> <span class="toc-text">14.4.2.1 jsp页面</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#14-4-2-2-controller"><span class="toc-number">1.16.4.5.</span> <span class="toc-text">14.4.2.2 controller</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-RESTful"><span class="toc-number">1.17.</span> <span class="toc-text">15. RESTful</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#15-1-什么是RESTful"><span class="toc-number">1.17.1.</span> <span class="toc-text">15.1 什么是RESTful</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-2-RESTful例子"><span class="toc-number">1.18.</span> <span class="toc-text">15.2 RESTful例子</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#15-2-1-controller"><span class="toc-number">1.18.1.</span> <span class="toc-text">15.2.1 controller</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-2-2-REST方法的前端控制器配置"><span class="toc-number">1.18.2.</span> <span class="toc-text">15.2.2 REST方法的前端控制器配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-2-3-对静态资源的解析"><span class="toc-number">1.18.3.</span> <span class="toc-text">15.2.3 对静态资源的解析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-拦截器"><span class="toc-number">1.19.</span> <span class="toc-text">16. 拦截器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#16-1-定义拦截器"><span class="toc-number">1.19.1.</span> <span class="toc-text">16.1 定义拦截器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-2-拦截器配置"><span class="toc-number">1.19.2.</span> <span class="toc-text">16.2 拦截器配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#16-2-1-针对HandlerMapping配置"><span class="toc-number">1.19.2.1.</span> <span class="toc-text">16.2.1 针对HandlerMapping配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#16-2-2-类似全局的拦截器"><span class="toc-number">1.19.2.2.</span> <span class="toc-text">16.2.2 类似全局的拦截器</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-3-两个拦截器执行情况总结"><span class="toc-number">1.19.3.</span> <span class="toc-text">16.3 两个拦截器执行情况总结</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#16-3-1-两个拦截器都放行"><span class="toc-number">1.19.3.1.</span> <span class="toc-text">16.3.1 两个拦截器都放行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#16-3-2-拦截器1放行，拦截器2不放行"><span class="toc-number">1.19.3.2.</span> <span class="toc-text">16.3.2 拦截器1放行，拦截器2不放行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#16-3-3-拦截器1不放行，拦截器2不放行"><span class="toc-number">1.19.3.3.</span> <span class="toc-text">16.3.3 拦截器1不放行，拦截器2不放行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#16-3-4-总结"><span class="toc-number">1.19.3.4.</span> <span class="toc-text">16.3.4 总结</span></a></li></ol></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">xDaShen</div><div class="author-info__description text-center">一个秘密的地方偷偷的记录</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">9</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">2</span></a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">xDaShen's Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a></span></div><div id="post-info"><div id="post-title">SpringMVC学习笔记</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-12-05</time></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="SpringMVC学习笔记"><a href="#SpringMVC学习笔记" class="headerlink" title="SpringMVC学习笔记"></a>SpringMVC学习笔记</h1><h2 id="1-SpringMVC框架"><a href="#1-SpringMVC框架" class="headerlink" title="1. SpringMVC框架"></a>1. SpringMVC框架</h2><h3 id="1-1-springmvc流程"><a href="#1-1-springmvc流程" class="headerlink" title="1.1 springmvc流程"></a>1.1 springmvc流程</h3><ol>
<li>用户发送请求至前端控制器<strong>DispatcherServlet</strong>。</li>
<li>DispatcherServlet收到请求调用<strong>HandlerMapping</strong>（处理器映射器）。</li>
<li>处理器映射器找到具体的处理器（可以根据xml配置、注解进行查找），生成处理器对象及处理器拦截器(如果有则生成)一并返回给DispatcherServlet。</li>
<li>DispatcherServlet调用<strong>HandlerAdapter</strong>（处理器适配器）。</li>
<li>HandlerAdapter经过适配调用具体的处理器<strong>Controller</strong>（也叫后端控制器）。</li>
<li>Controller执行完成返回<strong>ModelAndView</strong>。</li>
<li>HandlerAdapter将controller执行结果ModelAndView返回给DispatcherServlet。</li>
<li>DispatcherServlet将ModelAndView传给<strong>ViewReslover（</strong>视图解析器）。</li>
<li>ViewReslover解析后返回具体<strong>View</strong>（视图）。</li>
<li>DispatcherServlet根据View进行渲染视图（即将模型数据填充至视图中）。 </li>
<li>DispatcherServlet响应用户。</li>
</ol>
<h3 id="1-2-组件说明"><a href="#1-2-组件说明" class="headerlink" title="1.2 组件说明"></a>1.2 组件说明</h3><p>以下组件通常使用框架提供实现：</p>
<ul>
<li><strong>DispatcherServlet</strong>：作为前端控制器，整个流程控制的中心，控制其它组件执行，统一调度，降低组件之间的耦合性，提高每个组件的扩展性。</li>
<li><strong>HandlerMapping</strong>：通过扩展处理器映射器实现不同的映射方式，例如：配置文件方式，实现接口方式，注解方式等。 </li>
<li><strong>HandlAdapter</strong>：通过扩展处理器适配器，支持更多类型的处理器。</li>
<li><strong>ViewResolver</strong>：通过扩展视图解析器，支持更多类型的视图解析，例如：jsp、freemarker、pdf、excel等。</li>
</ul>
<h3 id="1-2-组件"><a href="#1-2-组件" class="headerlink" title="1.2 组件"></a>1.2 组件</h3><p><strong>1. 前端控制器DispatcherServlet（不需要工程师开发）,由框架提供</strong><br>作用：接收请求，响应结果，相当于转发器、中央处理器。有了dispatcherServlet减少了其它组件之间的耦合度。<br>用户请求到达前端控制器，它就相当于mvc模式中的c，dispatcherServlet是整个流程控制的中心，由它调用其它组件处理用户的请求，DispatcherServlet的存在降低了组件之间的耦合性。</p>
<p><strong>2. 处理器映射器HandlerMapping(不需要工程师开发),由框架提供</strong><br>作用：根据请求的url查找Handler<br>HandlerMapping负责根据用户请求找到Handler即处理器，springmvc提供了不同的映射器实现不同的映射方式，例如：配置文件方式，实现接口方式，注解方式等。</p>
<p><strong>3. 处理器适配器HandlerAdapter</strong><br>作用：按照特定规则（HandlerAdapter要求的规则）去执行Handler<br>通过HandlerAdapter对处理器进行执行，这是适配器模式的应用，通过扩展适配器可以对更多类型的处理器进行执行。</p>
<p><strong>4. 处理器Handler(需要工程师开发)</strong><br><strong>注意：编写Handler时按照HandlerAdapter的要求去做，这样适配器才可以去正确执行Handler</strong><br>Handler 是继DispatcherServlet前端控制器的后端控制器，在DispatcherServlet的控制下Handler对具体的用户请求进行处理。<br>由于Handler涉及到具体的用户业务请求，所以一般情况需要工程师根据业务需求开发Handler。</p>
<p><strong>5. 视图解析器View resolver(不需要工程师开发),由框架提供</strong><br>作用：进行视图解析，根据逻辑视图名解析成真正的视图（view）<br>View Resolver负责将处理结果生成View视图，View Resolver首先根据逻辑视图名解析成物理视图名即具体的页面地址，再生成View视图对象，最后对View进行渲染将处理结果通过页面展示给用户。 springmvc框架提供了很多的View视图类型，包括：jstlView、freemarkerView、pdfView等。<br>一般情况下需要通过页面标签或页面模版技术将模型数据通过页面展示给用户，需要由工程师根据业务需求开发具体的页面。</p>
<p><strong>6. 视图View(需要工程师开发jsp)</strong><br>View是一个接口，实现类支持不同的View类型（jsp、freemarker、pdf…）</p>
<p><strong>核心架构的具体流程步骤如下：</strong></p>
<ol>
<li>首先用户发送请求——&gt;DispatcherServlet，前端控制器收到请求后自己不进行处理，而是委托给其他的解析器进行处理，作为统一访问点，进行全局的流程控制；</li>
<li>DispatcherServlet——&gt;HandlerMapping， HandlerMapping 将会把请求映射为HandlerExecutionChain 对象（包含一个Handler 处理器（页面控制器）对象、多个HandlerInterceptor 拦截器）对象，通过这种策略模式，很容易添加新的映射策略；</li>
<li>DispatcherServlet——&gt;HandlerAdapter，HandlerAdapter 将会把处理器包装为适配器，从而支持多种类型的处理器，即适配器设计模式的应用；</li>
<li>HandlerAdapter——&gt;处理器功能处理方法的调用，HandlerAdapter 将会根据适配的结果调用真正的处理器的功能处理方法，完成功能处理；并返回一个ModelAndView 对象（包含模型数据、逻辑视图名）；</li>
<li>ModelAndView的逻辑视图名——&gt; ViewResolver， ViewResolver 将把逻辑视图名解析为具体的View，通过这种策略模式，很容易更换其他视图技术；</li>
<li>View——&gt;渲染，View会根据传进来的Model模型数据进行渲染，此处的Model实际是一个Map数据结构，因此很容易支持其他视图技术；</li>
<li>返回视图给DispatcherServlet，由DispatcherServlet返回响应给用户，到此一个流程结束。</li>
</ol>
<p>下边两个组件通常情况下需要开发：</p>
<p>Handler：处理器，即后端控制器，一般用controller表示。</p>
<p>View：视图，即展示给用户的界面，视图中通常需要标签语言展示模型数据。</p>
<h2 id="2-入门程序"><a href="#2-入门程序" class="headerlink" title="2. 入门程序"></a>2. 入门程序</h2><ol>
<li><p><strong>用idea给项目添加springmvc框架</strong></p>
</li>
<li><p><strong>配置前端控制器（web.xml中配置）</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置springmvc前端控制器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcher<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--指定springmvc配置文件路径</span></span><br><span class="line"><span class="comment">        默认加载/WEB-INF/*-servlet.xml	</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>/WEB-INF/springmvc.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcher<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.do<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>配置处理器适配器</strong></p>
<p>在/WEB-INF/dispatcher-servlet.xml中配置处理器适配器</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置处理器适配器</span></span><br><span class="line"><span class="comment">        所有的适配器都实现了HandlerAdapter接口</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>创建Handler</strong></p>
<p>需要实现controller接口，才能由org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter适配器执行</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> <span class="keyword">implements</span> <span class="title">Controller</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">handleRequest</span><span class="params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        List&lt;User&gt; userList = <span class="keyword">new</span> ArrayList&lt;User&gt;();</span><br><span class="line">        User user1 = <span class="keyword">new</span> User();</span><br><span class="line">        user1.setName(<span class="string">"xmos"</span>);</span><br><span class="line">        user1.setAge(<span class="number">23</span>);</span><br><span class="line">        user1.setAmt(<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">        User user2 = <span class="keyword">new</span> User();</span><br><span class="line">        user2.setName(<span class="string">"tmos"</span>);</span><br><span class="line">        user2.setAge(<span class="number">23</span>);</span><br><span class="line">        user2.setAmt(<span class="number">1200</span>);</span><br><span class="line"></span><br><span class="line">        Collections.addAll(userList, user1, user2);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//返回ModelAndView</span></span><br><span class="line">        ModelAndView modelAndView = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">        <span class="comment">//相当于request.setAttrubute，在jsp中通过users获取数据</span></span><br><span class="line">        modelAndView.addObject(<span class="string">"userList"</span>, userList);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//指定视图</span></span><br><span class="line">        modelAndView.setViewName(<span class="string">"/WEB-INF/jsp/user/userList.jsp"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> modelAndView;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>编写视图</strong></p>
</li>
<li><p><strong>配置Handler</strong></p>
<p>在dispatcher-servlet.xml文件配置Handler</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置Handler--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"/queryUses.do"</span> <span class="attr">class</span>=<span class="string">"com.xmos.ssm.controller.UserController"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>配置处理器映射器</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--处理器映射器</span></span><br><span class="line"><span class="comment">        将bean的name值作为url进行查找，需要在配置Handler时指定name</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>配置视图解析器</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--视图解析器</span></span><br><span class="line"><span class="comment">        配置jsp解析</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="3-非注解的处理器映射器和适配器"><a href="#3-非注解的处理器映射器和适配器" class="headerlink" title="3. 非注解的处理器映射器和适配器"></a>3. 非注解的处理器映射器和适配器</h2><h3 id="3-1-非注解的处理器映射器"><a href="#3-1-非注解的处理器映射器" class="headerlink" title="3.1 非注解的处理器映射器"></a>3.1 非注解的处理器映射器</h3><ul>
<li><p><strong>org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--处理器映射器</span></span><br><span class="line"><span class="comment">        BeanNameUrlHandlerMapping：通过处理器的name属性值匹配请求url</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>org.springframework.web.servlet.handler.SimpleUrlHandlerMapping</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--处理器映射器</span></span><br><span class="line"><span class="comment">        SimpleUrlHandlerMapping</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.handler.SimpleUrlHandlerMapping"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mappings"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--根据下面配置的url和处理器id进行映射--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"/login.do"</span>&gt;</span>loginController<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<p><strong>多个映射器可以并存，前端控制器判断url能让哪些映射器映射，就让正确的映射器处理。</strong></p>
<h3 id="3-2-非注解的处理器适配器"><a href="#3-2-非注解的处理器适配器" class="headerlink" title="3.2 非注解的处理器适配器"></a>3.2 非注解的处理器适配器</h3><ul>
<li><p><strong>org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter</strong></p>
<p><strong>要求编写的Handler实现 Controller接口。</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--处理器适配器</span></span><br><span class="line"><span class="comment">        SimpleControllerHandlerAdapter：要求处理器实现Controller接口</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter</strong></p>
<p><strong>要求编写的Handler实现 HttpRequestHandler接口。</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--处理器适配器</span></span><br><span class="line"><span class="comment">        HttpRequestHandlerAdapter：要求处理器实现HttpRequestHandler接口</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="4-DispatcherServlet-properties"><a href="#4-DispatcherServlet-properties" class="headerlink" title="4. DispatcherServlet.properties"></a>4. DispatcherServlet.properties</h2><p><strong>前端控制器从org.springframework.web.servlet.DispatcherServlet.properties中加载处理器映射器、适配器、视图解析器等组件，如果不在springmvc.xml中配置，则使用默认加载的。</strong></p>
<h2 id="4-1-注解的处理器映射器和适配器"><a href="#4-1-注解的处理器映射器和适配器" class="headerlink" title="4.1 注解的处理器映射器和适配器"></a>4.1 注解的处理器映射器和适配器</h2><ul>
<li>在spring3.1之前使用<strong>org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping</strong>注解映射器。</li>
<li>在spring3.1之后使用<strong>org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping</strong>注解映射器。</li>
</ul>
<ul>
<li>在spring3.1之前使用<strong>org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter</strong>注解适配器。</li>
<li>在spring3.1之后使用<strong>org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter</strong>注解适配器。</li>
</ul>
<h3 id="4-2-配置注解映射器和适配器"><a href="#4-2-配置注解映射器和适配器" class="headerlink" title="4.2 配置注解映射器和适配器"></a>4.2 配置注解映射器和适配器</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--注解映射器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--注解适配器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 使用 mvc:annotation-driven代替上边注解映射器和注解适配器配置</span></span><br><span class="line"><span class="comment"> mvc:annotation-driven默认加载很多的参数绑定方法，</span></span><br><span class="line"><span class="comment"> 比如json转换解析器就默认加载了，如果使用mvc:annotation-driven不用配置上边的RequestMappingHandlerMapping和RequestMappingHandlerAdapter</span></span><br><span class="line"><span class="comment"> 实际开发时使用mvc:annotation-driven</span></span><br><span class="line"><span class="comment">  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span>&gt;</span><span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-3-开发注解Handler"><a href="#4-3-开发注解Handler" class="headerlink" title="4.3 开发注解Handler"></a>4.3 开发注解Handler</h3><p><strong>使用注解的映射器和注解的适配器。（注解的映射器和注解的适配器必须配对使用）</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用Controller标识 它是一个控制器</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ItemsController3</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//用户登陆</span></span><br><span class="line">    <span class="comment">//@RequestMapping实现 对login方法和url进行映射，一个方法对应一个url</span></span><br><span class="line">    <span class="comment">//一般建议将url和方法写成一样</span></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/login"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">login</span><span class="params">(HttpServletRequest httpServletRequest)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        user.setName(httpServletRequest.getParameter(<span class="string">"name"</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//返回ModelAndView</span></span><br><span class="line">        ModelAndView modelAndView =  <span class="keyword">new</span> ModelAndView();</span><br><span class="line">        <span class="comment">//相当 于request的setAttribut，在jsp页面中通过itemsList取数据</span></span><br><span class="line">        modelAndView.addObject(<span class="string">"itemsList"</span>, itemsList);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//指定视图</span></span><br><span class="line">        modelAndView.setViewName(<span class="string">"/WEB-INF/jsp/items/itemsList.jsp"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> modelAndView;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-4-在spring容器中加载Handler"><a href="#4-4-在spring容器中加载Handler" class="headerlink" title="4.4 在spring容器中加载Handler"></a>4.4 在spring容器中加载Handler</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 对于注解的Handler可以单个配置</span></span><br><span class="line"><span class="comment"> 实际开发中建议使用组件扫描</span></span><br><span class="line"><span class="comment">  --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- &lt;bean class="com.xmos.demo.ssm.controller.LoginController" /&gt; --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 可以扫描controller、service、...</span></span><br><span class="line"><span class="comment">  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.xmos.demo.ssm"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="5-视图解析器（jsp）"><a href="#5-视图解析器（jsp）" class="headerlink" title="5. 视图解析器（jsp）"></a>5. 视图解析器（jsp）</h2><p>配置视图解析器的前后缀</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--视图解析器</span></span><br><span class="line"><span class="comment">        配置jsp解析</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置jsp路径前缀--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/jsp"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置jsp路径后缀--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>这样处理器就可以省略jsp路径的前缀和后缀了</strong></p>
<h2 id="6-RequestMapping"><a href="#6-RequestMapping" class="headerlink" title="6. @RequestMapping"></a>6. @RequestMapping</h2><ul>
<li><p>url映射</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/login"</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>窄化请求映射</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="comment">//对url进行管理，可以在这里定义根路径</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/ssm"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/login"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">login</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"login"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>限制http请求方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//限制http请求方法为get和post</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(value=<span class="string">"/login"</span>, method=&#123;RequestMethos.GET, RequestMethod.POST&#125;)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="7-controller方法的返回值"><a href="#7-controller方法的返回值" class="headerlink" title="7. controller方法的返回值"></a>7. controller方法的返回值</h2><ul>
<li><p>返回ModelAndView</p>
<p>需要方法结束时，定义ModelAndView，将model和view分别进行设置。</p>
</li>
<li><p>返回String</p>
<ul>
<li><p>返回逻辑视图名：真正的视图（jsp路径）=前缀+逻辑视图名+后缀</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="string">"user"</span>; <span class="comment">//相当于/WEB-INF/jsp/user.jsp</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>forward：页面转发，浏览器url不变，共享request</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="string">"forward:/WEB-INF/jsp/user.jsp"</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>redirect：重定向，浏览器url变化，不共享request</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//重定向只能访问浏览器能访问的路径</span></span><br><span class="line"><span class="keyword">return</span> <span class="string">"redirect:/index.jsp"</span>;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>返回void</p>
<p>在controller方法形参上可以定义request和response，使用request或response指定响应结果：</p>
<ol>
<li><strong>使用request转向页面</strong>，如下：</li>
</ol>
<p>request.getRequestDispatcher(“页面路径”).forward(request, response);</p>
<ol>
<li><strong>使用response页面重定向</strong>：</li>
</ol>
<p>response.sendRedirect(“url”)</p>
<ol>
<li><strong>使用response指定响应结果</strong>，例如响应json数据如下：</li>
</ol>
<p>response.setCharacterEncoding(“utf-8”);</p>
<p>response.setContentType(“application/json;charset=utf-8”);</p>
<p>response.getWriter().write(“json串”);</p>
</li>
</ul>
<h2 id="8-参数绑定"><a href="#8-参数绑定" class="headerlink" title="8. 参数绑定"></a>8. 参数绑定</h2><h3 id="8-1-spring参数绑定过程"><a href="#8-1-spring参数绑定过程" class="headerlink" title="8.1 spring参数绑定过程"></a>8.1 spring参数绑定过程</h3><p>从客户端请求key/value数据，经过spring提供的各种converter组件进行参数绑定，将key/value数据绑定到controller方法的形参上。springmvc中，接收页面提交的数据是通过<strong>方法形参</strong>来接收。而不是在controller类定义成员变更接收。</p>
<h3 id="8-2-默认支持的类型"><a href="#8-2-默认支持的类型" class="headerlink" title="8.2 默认支持的类型"></a>8.2 默认支持的类型</h3><p>直接在controller方法形参上定义下边类型的对象，就可以使用这些对象。在参数绑定过程中，如果遇到下边类型直接进行绑定。</p>
<ul>
<li><p><strong>HttpServletRequest</strong></p>
<p>通过request对象获取请求信息</p>
</li>
<li><p><strong>HttpServletResponse</strong></p>
<p>通过response处理响应信息</p>
</li>
<li><p><strong>HttpSession</strong></p>
<p>通过session对象得到session中存放的对象</p>
</li>
<li><p><strong>Model/ModelMap</strong></p>
<p>model是一个接口，modelMap是一个接口实现 。</p>
<p>作用：将model数据填充到request域。</p>
</li>
</ul>
<h3 id="8-3-简单类型"><a href="#8-3-简单类型" class="headerlink" title="8.3 简单类型"></a>8.3 简单类型</h3><p>通过@RequestParam对简单类型的参数进行绑定。</p>
<p>如果不使用@RequestParam，<strong>要求request传入参数名称和controller方法的形参名称一致</strong>，方可绑定成功。</p>
<p>如果使用@RequestParam，不用限制request传入参数名称和controller方法的形参名称一致。</p>
<p>通过required属性指定参数是否必须要传入，如果设置为true，没有传入参数，则会报错。</p>
<h3 id="8-4-pojo绑定"><a href="#8-4-pojo绑定" class="headerlink" title="8.4 pojo绑定"></a>8.4 pojo绑定</h3><ul>
<li><p>页面中input的name值和controller的pojo属性名一致</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"name"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>url参数的属性名和pojo的属性名一致</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:8080/login?name=xmos</span><br></pre></td></tr></table></figure>
</li>
<li><p>http请求方法体中请求参数的属性名和pojo的属性名一致</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="8-5-复杂类型参数绑定"><a href="#8-5-复杂类型参数绑定" class="headerlink" title="8.5 复杂类型参数绑定"></a>8.5 复杂类型参数绑定</h3><p><strong>只要页面中的参数名和controller形参名相同即可，一般开发中使用包装类来接受复杂参数类型，在包装类中创建绑定参数的set方法</strong></p>
<h3 id="8-5-自定义参数绑定"><a href="#8-5-自定义参数绑定" class="headerlink" title="8.5 自定义参数绑定"></a>8.5 自定义参数绑定</h3><h4 id="8-51-自定义日期类型绑定"><a href="#8-51-自定义日期类型绑定" class="headerlink" title="8.51 自定义日期类型绑定"></a>8.51 自定义日期类型绑定</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomDateConverter</span> <span class="keyword">implements</span> <span class="title">Converter</span>&lt;<span class="title">String</span>, <span class="title">Date</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Date <span class="title">convert</span><span class="params">(String source)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//实现日期串转成日期类型(yyyy-MM-dd HH:mm:ss)</span></span><br><span class="line">        SimpleDateFormat sdf = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//转换成功直接返回</span></span><br><span class="line">            <span class="keyword">return</span> sdf.parse(source);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ParseException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//如果参数绑定失败返回null</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="8-52-配置自定义参数绑定"><a href="#8-52-配置自定义参数绑定" class="headerlink" title="8.52 配置自定义参数绑定"></a>8.52 配置自定义参数绑定</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--开启注解方式开发Handler</span></span><br><span class="line"><span class="comment">        conversion-service:使用自定义参数绑定</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span> <span class="attr">conversion-service</span>=<span class="string">"conversionService"</span>&gt;</span><span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--自定义参数绑定--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"conversionService"</span> <span class="attr">class</span>=<span class="string">"org.springframework.format.support.FormattingConversionServiceFactoryBean"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--转换器--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"converters"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--日期类型转换--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"com.xmos.demo.ssm.converter.CustomDateConverter"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="9-乱码问题"><a href="#9-乱码问题" class="headerlink" title="9. 乱码问题"></a>9. 乱码问题</h2><h3 id="9-1-post乱码"><a href="#9-1-post乱码" class="headerlink" title="9.1 post乱码"></a>9.1 post乱码</h3><p>在web.xml中加入过滤器</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="9-2-get乱码"><a href="#9-2-get乱码" class="headerlink" title="9.2 get乱码"></a>9.2 get乱码</h3><ul>
<li><p>方式一：修改tomcat配置文件添加编码与工程编码一致</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Connector</span> <span class="attr">URIEncoding</span>=<span class="string">"utf-8"</span> <span class="attr">connectionTimeout</span>=<span class="string">"20000"</span> <span class="attr">port</span>=<span class="string">"8080"</span> <span class="attr">protocol</span>=<span class="string">"HTTP/1.1"</span> <span class="attr">redirectPort</span>=<span class="string">"8443"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>方式二：对参数进行重新编码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ISO8859-1是tomcat默认编码，需要将tomcat编码后的内容按utf-8编码</span></span><br><span class="line">String name = <span class="keyword">new</span> String(request.getParameter(<span class="string">"name"</span>).getBytes(<span class="string">"ISO8859-1"</span>),<span class="string">"UTF-8"</span>);</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="10-springmvc校验"><a href="#10-springmvc校验" class="headerlink" title="10. springmvc校验"></a>10. springmvc校验</h2><h2 id="11-数据回显"><a href="#11-数据回显" class="headerlink" title="11. 数据回显"></a>11. 数据回显</h2><h4 id="11-1-什么是数据回显"><a href="#11-1-什么是数据回显" class="headerlink" title="11.1 什么是数据回显"></a>11.1 什么是数据回显</h4><p>提交后，如果出现错误，将刚才提交的数据回显到刚才的提交页面。</p>
<h3 id="11-2-pojo数据回显"><a href="#11-2-pojo数据回显" class="headerlink" title="11.2 pojo数据回显"></a>11.2 pojo数据回显</h3><ul>
<li><p>springmvc默认对pojo数据进行回显，pojo数据传入controller方法后，springmvc自动将pojo数据放到request域，key等于pojo类型（首字母小写），可以使用@ModelAttribute指定pojo回显到页面在request中的key</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//user会自动放在request中</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">login</span><span class="params">(User user)</span></span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"$&#123;user.name&#125;"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>@ModelAttribute还可以将方法的返回值传到页面</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ModelAttrubute</span>(<span class="string">"user"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> User <span class="title">login</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> User(<span class="string">"xmos"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>最简单的方法是用Model.setAttrubute()方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">login</span><span class="params">(Model model)</span> </span>&#123;</span><br><span class="line">    model.setAttrubute(<span class="string">"user"</span>,<span class="keyword">new</span> User(<span class="string">"xmos"</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"forward:/index.jsp"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="11-3-简单类型数据回显"><a href="#11-3-简单类型数据回显" class="headerlink" title="11.3 简单类型数据回显"></a>11.3 简单类型数据回显</h3><p>不会自动回显，最简单的方法是用Model.setAttrubute()方法</p>
<h2 id="12-springmvc校验（to-do）"><a href="#12-springmvc校验（to-do）" class="headerlink" title="12. springmvc校验（to do）"></a>12. springmvc校验（to do）</h2><h2 id="12-异常处理"><a href="#12-异常处理" class="headerlink" title="12. 异常处理"></a>12. 异常处理</h2><h3 id="12-1-异常处理思路"><a href="#12-1-异常处理思路" class="headerlink" title="12.1 异常处理思路"></a>12.1 异常处理思路</h3><p>系统中异常包括两类：编译期异常和运行时异常RuntimeException，前者通过捕获异常从而获取异常信息，后者主要通过规范代码开发、测试通过手段减少运行时异常的发生。</p>
<p>系统的dao、service、controller出现异常都通过throws Exception向上抛出，最后由springmvc前端控制器交由异常处理器进行异常处理。</p>
<p>springmvc提供全局异常处理器（一个系统只有一个异常处理器）进行统一异常处理。</p>
<h3 id="12-2-自定义异常类"><a href="#12-2-自定义异常类" class="headerlink" title="12.2 自定义异常类"></a>12.2 自定义异常类</h3><p>对不同的异常类型定义异常类，继承RuntimeException</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserException</span> <span class="keyword">extends</span> <span class="title">RuntimeException</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UserException</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UserException</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="12-3-全局异常处理器"><a href="#12-3-全局异常处理器" class="headerlink" title="12.3 全局异常处理器"></a>12.3 全局异常处理器</h3><ol>
<li><p>流程：系统遇到异常，直接抛出，最终前端控制器调用全局异常处理器。</p>
</li>
<li><p>全局异常处理思路：</p>
<p>解析出异常类型</p>
<p>如果该异常类型是系统自定义的异常，直接取出异常信息，在错误页面展示</p>
<p>如果该异常类型不是系统自定义的异常，构造一个自定义的异常类型（消息为未知错误）</p>
</li>
<li><p>实现springmvc提供的HandlerExceptionResolver接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GlobalExceptionHandler</span> <span class="keyword">implements</span> <span class="title">HandlerExceptionResolver</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">resolveException</span><span class="params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o, Exception e)</span> </span>&#123;</span><br><span class="line">        String msg = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (e <span class="keyword">instanceof</span> UserException) &#123;</span><br><span class="line">            msg = e.getMessage();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            msg = <span class="string">"未知错误"</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ModelAndView modelAndView = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">        modelAndView.addObject(<span class="string">"msg"</span>,msg);</span><br><span class="line">        modelAndView.setViewName(<span class="string">"error"</span>);</span><br><span class="line">        <span class="keyword">return</span> modelAndView;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>错误页面</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">contentType</span>=<span class="string">"text/html;charset=UTF-8"</span> <span class="attr">language</span>=<span class="string">"java"</span> %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>错误提示<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    $&#123;msg&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在springmvc配置文件中配置全局异常处理器</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--全局异常处理器</span></span><br><span class="line"><span class="comment">        只要实现了HandlerExceptionResolver接口的就是全局异常处理器</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"com.xmos.demo.ssm.exception.GlobalExceptionHandler"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>异常测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/login"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">login</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (Objects.equals(user.getName(), <span class="string">"xmos"</span>)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UserException(<span class="string">"用户名错误"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"forward:/index.jsp"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="13-上传"><a href="#13-上传" class="headerlink" title="13. 上传"></a>13. 上传</h2><h3 id="13-1-springmvc中添加对多部件类型解析"><a href="#13-1-springmvc中添加对多部件类型解析" class="headerlink" title="13.1  springmvc中添加对多部件类型解析"></a>13.1  springmvc中添加对多部件类型解析</h3><p>在页面form中提交enctype=”multipart/form-data”的数据时，需要springmvc对multipart类型的数据进行解析，在springmvc.xml中配置multipart类型解析器。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--文件上传--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">""</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.multipart.commons.CommonsMultipartResolver"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--设置文件上传的最大尺寸为5M--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxUploadSize"</span> <span class="attr">value</span>=<span class="string">"5242880"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="13-2-添加上传的jar包"><a href="#13-2-添加上传的jar包" class="headerlink" title="13.2 添加上传的jar包"></a>13.2 添加上传的jar包</h3><p>maven中添加相关依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--文件上传--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="13-3-上传图片页面"><a href="#13-3-上传图片页面" class="headerlink" title="13.3 上传图片页面"></a>13.3 上传图片页面</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">contentType</span>=<span class="string">"text/html;charset=UTF-8"</span> <span class="attr">language</span>=<span class="string">"java"</span> %&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">%@</span> <span class="attr">taglib</span> <span class="attr">prefix</span>=<span class="string">"c"</span> <span class="attr">uri</span>=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> %&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">title</span>&gt;</span>文件上传<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"$&#123;pageContext.request.contextPath&#125;/upload.do"</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">enctype</span>=<span class="string">"multipart/form-data"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">c:if</span> <span class="attr">test</span>=<span class="string">"$&#123;user_pic_name !=null&#125;"</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/pic/$&#123;user_pic_name&#125;"</span> <span class="attr">width</span>=<span class="string">"100"</span> <span class="attr">height</span>=<span class="string">"100"</span>/&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">c:if</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">name</span>=<span class="string">"user_pic"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="13-4-controller"><a href="#13-4-controller" class="headerlink" title="13.4 controller"></a>13.4 controller</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FileUploadController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/upload"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">fileUpload</span><span class="params">(HttpServletRequest request, Model model, MultipartFile user_pic)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		<span class="comment">//通过input的name和MultipartFile变量名进行参数绑定</span></span><br><span class="line">        <span class="keyword">if</span> (user_pic != <span class="keyword">null</span>) &#123;</span><br><span class="line">            String fileName = user_pic.getOriginalFilename();</span><br><span class="line">            String path = request.getServletContext().getRealPath(<span class="string">"/"</span>)+<span class="string">"/pic/"</span>;</span><br><span class="line">            String filePath = path + fileName;</span><br><span class="line">            user_pic.transferTo(<span class="keyword">new</span> File(filePath));</span><br><span class="line">            model.addAttribute(<span class="string">"user_pic_name"</span>, fileName);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"fileupload"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="14-json数据交互"><a href="#14-json数据交互" class="headerlink" title="14. json数据交互"></a>14. json数据交互</h2><h3 id="14-1-为什么要进行json数据交互"><a href="#14-1-为什么要进行json数据交互" class="headerlink" title="14.1 为什么要进行json数据交互"></a>14.1 为什么要进行json数据交互</h3><p>json数据格式在接口调用中、html页面中较常用，json格式比较简单，解析还比较方便。</p>
<p>比如：webservice接口，传输json数据。</p>
<h3 id="14-2-SpringMVC进行json交互"><a href="#14-2-SpringMVC进行json交互" class="headerlink" title="14.2 SpringMVC进行json交互"></a>14.2 SpringMVC进行json交互</h3><ul>
<li>请求json、输出json，要求请求的是json串，所以在前端页面中需要将请求的内容转成json，不太方便。</li>
<li>请求key/value、输出json。此方法比较常用。</li>
</ul>
<h3 id="14-3-环境准备"><a href="#14-3-环境准备" class="headerlink" title="14.3 环境准备"></a>14.3 环境准备</h3><h4 id="14-3-1-maven添加相关依赖"><a href="#14-3-1-maven添加相关依赖" class="headerlink" title="14.3.1 maven添加相关依赖"></a>14.3.1 maven添加相关依赖</h4><h4 id="14-3-2-配置json转换器"><a href="#14-3-2-配置json转换器" class="headerlink" title="14.3.2 配置json转换器"></a>14.3.2 配置json转换器</h4><ul>
<li><p>在注解适配器中加入messageConverters</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--注解适配器 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"messageConverters"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.http.converter.json.MappingJacksonHttpMessageConverter"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>使用&lt;mvc:annotation-driven /&gt; 则不用定义上边的内容</strong></p>
</li>
</ul>
<h3 id="14-4-json交互测试"><a href="#14-4-json交互测试" class="headerlink" title="14.4 json交互测试"></a>14.4 json交互测试</h3><h4 id="14-4-1-输入json，输出json"><a href="#14-4-1-输入json，输出json" class="headerlink" title="14.4.1 输入json，输出json"></a>14.4.1 输入json，输出json</h4><h5 id="14-4-1-1-jsp页面"><a href="#14-4-1-1-jsp页面" class="headerlink" title="14.4.1.1 jsp页面"></a>14.4.1.1 jsp页面</h5><p>使用jquery的ajax提交json串，对输出的json结果进行解析。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">contentType</span>=<span class="string">"text/html;charset=UTF-8"</span> <span class="attr">language</span>=<span class="string">"java"</span> %&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">title</span>&gt;</span>json交互测试<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"$&#123;pageContext.request.contextPath&#125;/js/jquery/jquery-3.3.1.js"</span>/&gt;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span></span><br><span class="line">        function requestJson() &#123;</span><br><span class="line">            $.ajax(&#123;</span><br><span class="line">                type: 'post',</span><br><span class="line">                url: '$&#123;pageContext.request.contextPath&#125;/json.do',</span><br><span class="line">                //数据格式是json</span><br><span class="line">                contentType: 'application/json;charset=utf-8',</span><br><span class="line">                data: '&#123;"name":"xmos","age":23,"amt":10000&#125;',</span><br><span class="line">                success: function (data) &#123; //返回json结果</span><br><span class="line">                    $(document).write(data)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        function requestNoJson() &#123;</span><br><span class="line">            $.ajax(&#123;</span><br><span class="line">                type: 'post',</span><br><span class="line">                url: '$&#123;pageContext.request.contextPath&#125;/json.do',</span><br><span class="line">                data: 'name=xmos&amp;age=23&amp;amt=10000',</span><br><span class="line">                success: function (data) &#123;</span><br><span class="line">                    $(document).wirte(data)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"发送json串"</span> <span class="attr">onclick</span>=<span class="string">"requestJson()"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"发送key/value串"</span> <span class="attr">onclick</span>=<span class="string">"requestNoJson()"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="14-4-1-2-controller"><a href="#14-4-1-2-controller" class="headerlink" title="14.4.1.2 controller"></a>14.4.1.2 controller</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        @ResponseBody：返回User对象转换成json</span></span><br><span class="line"><span class="comment">        @RequestBody：将请求的json转换成User对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/json"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">requestJson</span><span class="params">(@RequestBody User user)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="14-4-2-输入key-value，输出是json串"><a href="#14-4-2-输入key-value，输出是json串" class="headerlink" title="14.4.2 输入key/value，输出是json串"></a>14.4.2 输入key/value，输出是json串</h4><h4 id="14-4-2-1-jsp页面"><a href="#14-4-2-1-jsp页面" class="headerlink" title="14.4.2.1 jsp页面"></a>14.4.2.1 jsp页面</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">contentType</span>=<span class="string">"text/html;charset=UTF-8"</span> <span class="attr">language</span>=<span class="string">"java"</span> %&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">title</span>&gt;</span>json交互测试<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"$&#123;pageContext.request.contextPath&#125;/js/jquery/jquery-3.3.1.js"</span>/&gt;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span></span><br><span class="line">        function requestJson() &#123;</span><br><span class="line">            $.ajax(&#123;</span><br><span class="line">                type: 'post',</span><br><span class="line">                url: '$&#123;pageContext.request.contextPath&#125;/json.do',</span><br><span class="line">                //数据格式是json</span><br><span class="line">                contentType: 'application/json;charset=utf-8',</span><br><span class="line">                data: '&#123;"name":"xmos","age":23,"amt":10000&#125;',</span><br><span class="line">                success: function (data) &#123; //返回json结果</span><br><span class="line">                    $(document).write(data)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        function requestNoJson() &#123;</span><br><span class="line">            $.ajax(&#123;</span><br><span class="line">                type: 'post',</span><br><span class="line">                url: '$&#123;pageContext.request.contextPath&#125;/json.do',</span><br><span class="line">                data: 'name=xmos&amp;age=23&amp;amt=10000',</span><br><span class="line">                success: function (data) &#123;</span><br><span class="line">                    $(document).wirte(data)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"发送json串"</span> <span class="attr">onclick</span>=<span class="string">"requestJson()"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"发送key/value串"</span> <span class="attr">onclick</span>=<span class="string">"requestNoJson()"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="14-4-2-2-controller"><a href="#14-4-2-2-controller" class="headerlink" title="14.4.2.2 controller"></a>14.4.2.2 controller</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        @ResponseBody：返回User对象转换成json</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/json"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">requestJson</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="15-RESTful"><a href="#15-RESTful" class="headerlink" title="15. RESTful"></a>15. RESTful</h2><h3 id="15-1-什么是RESTful"><a href="#15-1-什么是RESTful" class="headerlink" title="15.1 什么是RESTful"></a>15.1 什么是RESTful</h3><blockquote>
<p>RESTful架构，就是目前最流行的一种互联网软件架构。它结构清晰、符合标准、易于理解、扩展方便，所以正得到越来越多网站的采用。RESTful（即Representational State Transfer的缩写）其实是一个开发理念，是对http的很好的诠释。</p>
</blockquote>
<ul>
<li><p>对url进行规范，写RESTful格式的url</p>
<p>非REST的url：http://…../queryItems.action?id=001&amp;type=T01</p>
<p>REST的url风格：http://…./queryItems/<strong>01</strong></p>
<p>特点：url简洁，将参数通过url传到服务端</p>
</li>
<li><p>http的方法规范</p>
<p>不管是删除、添加、更新、查找，使用的url是一致的，后台controller通过判断http方法，执行相应的操作</p>
<ul>
<li>get：查找</li>
<li>put：修改</li>
<li>post：新增</li>
<li>delete：删除</li>
</ul>
</li>
<li><p>对http的contentType规范</p>
<p>请求时指定contentType，如需要json则指定application/json</p>
</li>
</ul>
<h2 id="15-2-RESTful例子"><a href="#15-2-RESTful例子" class="headerlink" title="15.2 RESTful例子"></a>15.2 RESTful例子</h2><h3 id="15-2-1-controller"><a href="#15-2-1-controller" class="headerlink" title="15.2.1 controller"></a>15.2.1 controller</h3><p><strong>设置返回的数据类型为json：</strong></p>
<ul>
<li>整个类的方法返回的都是json数据<ul>
<li>在类上添加@Controller和@ResponseBody注解</li>
<li>在类上添加@RestController注解（常用）</li>
</ul>
</li>
<li>类的某些方法返回json数据<ol>
<li>在类上添加@Controller注解</li>
<li>在方法上添加@ResonseBody</li>
</ol>
</li>
</ul>
<p><strong>设置请求的数据类型为json：</strong></p>
<p>在方法的形参前添加@RequestBody注解</p>
<h3 id="15-2-2-REST方法的前端控制器配置"><a href="#15-2-2-REST方法的前端控制器配置" class="headerlink" title="15.2.2 REST方法的前端控制器配置"></a>15.2.2 REST方法的前端控制器配置</h3><p>修改web.xml，把url-pattern配置的*.do改为/，表示映射所有请求</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcher<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- RESTful配置 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="15-2-3-对静态资源的解析"><a href="#15-2-3-对静态资源的解析" class="headerlink" title="15.2.3 对静态资源的解析"></a>15.2.3 对静态资源的解析</h3><p><strong>配置前端控制器的url-parttern中指定/，对静态资源的解析会失败</strong></p>
<p><strong>解决方法：</strong>在springmvc.xml中添加静态资源解析方法</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">localtion</span>=<span class="string">"/js/"</span> <span class="attr">mapping</span>=<span class="string">"/js/**"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">localtion</span>=<span class="string">"/img/"</span> <span class="attr">mapping</span>=<span class="string">"/img/**"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="16-拦截器"><a href="#16-拦截器" class="headerlink" title="16. 拦截器"></a>16. 拦截器</h2><h3 id="16-1-定义拦截器"><a href="#16-1-定义拦截器" class="headerlink" title="16.1 定义拦截器"></a>16.1 定义拦截器</h3><p>定义拦截器，需要实现HandlerInterceptor接口。接口中提供三个方法，根据需求实现其中的方法即可。</p>
<ul>
<li>preHandle：进入Handler方法之前执行，常用于身份认证、授权。</li>
<li>postHandle：进入Handler方法之后，返回ModelAndView之前执行，常用作指定公共模型或试图。</li>
<li>afterCompletion：Handler执行完后执行，常用作统一异常处理、统一日志处理</li>
</ul>
<h3 id="16-2-拦截器配置"><a href="#16-2-拦截器配置" class="headerlink" title="16.2 拦截器配置"></a>16.2 拦截器配置</h3><h4 id="16-2-1-针对HandlerMapping配置"><a href="#16-2-1-针对HandlerMapping配置" class="headerlink" title="16.2.1 针对HandlerMapping配置"></a>16.2.1 针对HandlerMapping配置</h4><p>springmvc拦截器针对HandlerMapping进行拦截设置，如果在某个HandlerMapping中配置拦截，经过该 HandlerMapping映射成功的handler最终使用该拦截器。<strong>一般不推荐使用。</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"interceptors"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">"handlerInterceptor1"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">"handlerInterceptor2"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"handlerInterceptor1"</span> <span class="attr">class</span>=<span class="string">"springmvc.intercapter.HandlerInterceptor1"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"handlerInterceptor2"</span> <span class="attr">class</span>=<span class="string">"springmvc.intercapter.HandlerInterceptor2"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="16-2-2-类似全局的拦截器"><a href="#16-2-2-类似全局的拦截器" class="headerlink" title="16.2.2 类似全局的拦截器"></a>16.2.2 类似全局的拦截器</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--拦截器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--多个拦截器，依次执行--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--/**表示拦截所有请求--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">"/**"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"com.xmos.demo.ssm.interceptor.LoginInterceptor"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="16-3-两个拦截器执行情况总结"><a href="#16-3-两个拦截器执行情况总结" class="headerlink" title="16.3 两个拦截器执行情况总结"></a>16.3 两个拦截器执行情况总结</h3><h4 id="16-3-1-两个拦截器都放行"><a href="#16-3-1-两个拦截器都放行" class="headerlink" title="16.3.1 两个拦截器都放行"></a>16.3.1 两个拦截器都放行</h4><ul>
<li>preHandle方法按顺序执行。</li>
<li>postHandle和afterCompletion按拦截器配置的逆向顺序执行。</li>
</ul>
<h4 id="16-3-2-拦截器1放行，拦截器2不放行"><a href="#16-3-2-拦截器1放行，拦截器2不放行" class="headerlink" title="16.3.2 拦截器1放行，拦截器2不放行"></a>16.3.2 拦截器1放行，拦截器2不放行</h4><ul>
<li>拦截器1放行，拦截器2 preHandle才会执行。</li>
<li>拦截器2 preHandle不放行，拦截器2 postHandle和afterCompletion不会执行。</li>
<li>只要有一个拦截器不放行，postHandle就不会执行。</li>
</ul>
<h4 id="16-3-3-拦截器1不放行，拦截器2不放行"><a href="#16-3-3-拦截器1不放行，拦截器2不放行" class="headerlink" title="16.3.3 拦截器1不放行，拦截器2不放行"></a>16.3.3 拦截器1不放行，拦截器2不放行</h4><ul>
<li>拦截器1postHandle和afterCompletion不会执行。</li>
<li>拦截器2不会执行。</li>
</ul>
<h4 id="16-3-4-总结"><a href="#16-3-4-总结" class="headerlink" title="16.3.4 总结"></a>16.3.4 总结</h4><p>根据测试结果，对拦截器可以如下应用：</p>
<ul>
<li>统一日志处理拦截器，需要该 拦截器preHandle一定要放行，且将它放在拦截器链接中第一个位置。</li>
<li>登陆认证拦截器，放在拦截器链接中第一个位置。权限校验拦截器，放在登陆认证拦截器之后（因为登陆通过后才校验权限）。</li>
</ul>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">xDaShen</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://yoursite.com/2018/12/05/SpringMVC学习笔记/">http://yoursite.com/2018/12/05/SpringMVC学习笔记/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/学习笔记/">学习笔记</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2018/12/05/MyBatis学习笔记/"><i class="fa fa-chevron-left">  </i><span>MyBatis学习笔记</span></a></div><div class="next-post pull-right"><a href="/2018/12/05/Spring学习笔记/"><span>Spring学习笔记</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2019 By xDaShen</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
}</script></body></html>